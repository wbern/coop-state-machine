<html>
    <head>
        <script>
            ;(function() {
                const workerCode = `
                /* WORKER_CODE */
                `
                const workerBlob = new Blob([workerCode], {
                    type: 'text/javascript',
                })
                const workerBlobUrl = URL.createObjectURL(workerBlob)

                const worker = new Worker(workerBlobUrl)

                worker.onmessage = function(event) {
                    // got a command
                    switch (event.data) {
                        case 'noop':
                            console.log('action by inaction')
                            break
                        case 'choke':
                            console.log('epic fail')
                            break
                        default:
                            console.log('received action: ' + event.data)
                            break
                    }

                    window.postMessage(event.data, '*')
                }
                debugger
                worker.postMessage({
                    name: 'tick',
                    /* DATA_CODE */
                })
            })()
        </script>
    </head>
</html>
